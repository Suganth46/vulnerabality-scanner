export function displayResults(container, data) {
    const results = data[0];
    const checks = results.checks;
    
    let html = `
        <div class="summary-stats">
            <div class="stat-card">
                <div class="stat-value">${countStatus(checks, 'safe')}</div>
                <div class="stat-label">Passed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${countStatus(checks, 'warning')}</div>
                <div class="stat-label">Warnings</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">${countStatus(checks, 'danger')}</div>
                <div class="stat-label">Critical</div>
            </div>
        </div>
    `;

    for (const [key, check] of Object.entries(checks)) {
        html += `
            <div class="result-card">
                <h3>
                    <span class="status-indicator status-${check.status}"></span>
                    ${check.name}
                </h3>
                ${check.findings && check.findings.length > 0 ? `
                    <ul class="details-list">
                        ${check.findings.map(finding => `
                            <li>${finding.detail}</li>
                        `).join('')}
                    </ul>
                ` : '<p class="text-success">No issues found</p>'}
            </div>
        `;
    }

    container.innerHTML = html;
    container.classList.add('show');
    updateVulnerabilityChart(checks);
}

function countStatus(checks, status) {
    return Object.values(checks).filter(check => check.status === status).length;
}